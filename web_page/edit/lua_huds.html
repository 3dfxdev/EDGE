<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN">
<html lang="en">
<head>
  <meta http-equiv="content-type" content="text/html; charset=iso-8859-1">
  <meta name="robots" content="all">

  <title> Lua HUDs </title>

  <style type="text/css" title="currentStyle">
     TABLE {
        border: 1px solid black;
        background-color: #ffd;
     }
     TABLE TD {
        border-bottom: 1px solid #666666;
     }
     .L1 {
        width: 8em;
        text-align: center;
     }
     .L2 {
        width: 16em;
        text-align: left;
        border-left: 1px solid #666666;
     }
     PRE {
        margin-left: 24px;
        margin-right: 24px;
        font-size: x-large;
        font-family: monospace;
        color: #ddd;
        background-color: black;
     }
     .VAR {
        color: #3333FF;
        font-size: x-large;
        font-family: monospace;
     }
     .FUNC {
        color: #22AA22;
        font-size: x-large;
        font-family: monospace;
     }
  </style>
</head>

<body>

<h1>Lua HUD Manual</h1>

by Andrew Apted. &nbsp; April 2008


<h2>OVERVIEW</h2>

Lua is a scripting language, which is quite easy to
learn even if you've never programmed before.
More information can be found here:
<a href="http://www.lua.org">
Lua home page</a>

<p>
EDGE looks for several lumps to load Lua scripts from.
Lumps called "LUAUTIL#" (where # is a digit) contain
utility code, useful stuff that is not HUD-related,
whereas lumps called "LUAHUD#" contain the code
for drawing the HUD (which is nearly everything on
the screen while the user is playing a level).

<p>
The following lumps are looked for (in the order listed) and
are loaded when present.  Each lump is only loaded once, so
when two pwads have a "LUAHUD1" lump (for example), then only
the second one is loaded.

<center>
<table>
<tr>
  <td class="L1"><b>LUMP</b></td>
  <td class="L2"><b>&nbsp;Source</b></td>
</tr>
<tr>
  <td class="L1">LUAUTIL0</td>
  <td class="L2">&nbsp;from EDGE.WAD</td>
</tr>
<tr>
  <td class="L1">LUAUTIL1</td>
  <td class="L2">&nbsp;from a TC/Mod</td>
</tr>
<tr>
  <td class="L1">LUAUTIL2</td>
  <td class="L2">&nbsp;from an Add-on</td>
</tr>

<tr>
  <td class="L1">LUAHUD0</td>
  <td class="L2">&nbsp;from EDGE.WAD</td>
</tr>
<tr>
  <td class="L1">LUAHUD1</td>
  <td class="L2">&nbsp;from a TC/Project</td>
</tr>
<tr>
  <td class="L1">LUAHUD2</td>
  <td class="L2">&nbsp;from a Mod/Addon</td>
</tr>
</table>
</center>

<p>
The lumps ending with '0' are the ones in EDGE.WAD and should not be
replaced by custom pwads (especially LUAUTIL0 which has some important
house-keeping functions).
Lumps ending with '1' are for large projects and Total Conversions,
which generally have new maps, textures and monsters.
Lumps ending with '2' are for smaller mods/addons, stuff like new
weapons, which could be used in addition to a large project or TC.


<h2>CONTENTS</h2>

The contents of each lump is simply the text of the Lua code.

<p>
The engine provides two modules: the "hud" module provides drawing
functions and general queries, whereas the "player" module provides
query functions about the current player.  All of their functions
and variables are described in separate sections below.

<p>
In order to customise the default HUDs, your Lua code needs to
redefine one of the existing functions, as follows:

<p>
<b>doom_status_bar()</b> : replace this function if you only want to
customise the full status bar (including the one shown in the
automap screen).
The size has to be the same (width 320, height 32).

<p>
<b>overlay_status_bar()</b> : write your own version of this
function if you only want to change the overlay status bar.

<p>
<b>doom_automap()</b> : this function draws the automap
screen (including the status bar at the bottom).  Replacing it
means you can show other information here instead of
(or in addition to) the automap.

<p>
<b>hud.draw_all()</b> : this is the function which EDGE calls
to draw [u]everything[/u].  The normal version (in edge.wad)
will call the above functions depending on the current HUD
number and whether the user is in the automap or not.
Replacing this function gives you total control: you could
provide more or less huds that the usual three, ignore the
automap mode completely if you wanted, or even draw the view
from multiple players.


<h2>HUD MODULE<h2>


<h3>General Queries</h3>

<p><span class="VAR">hud.automap</span>

<p><span class="VAR">hud.which</span>

<p><span class="VAR">hud.now_time</span>

<p><span class="VAR">hud.passed_time</span>

<p><span class="FUNC">hud.game_mode()</span>

<p><span class="FUNC">hud.game_name()</span>

<p><span class="FUNC">hud.map_name()</span>

<p><span class="FUNC">hud.map_title()</span>


<h3>Drawing Stuff</h3>

<p><span class="FUNC">hud.coord_sys(w, h)</span>

<p><span class="FUNC">hud.text_font(name)</span>

<p><span class="FUNC">hud.text_color(name)</span>

<p><span class="FUNC">hud.set_scale(value)</span>

<p><span class="FUNC">hud.set_alpha(value)</span>

<p><span class="FUNC">hud.solid_box(x, y, w, h, color)</span>

<p><span class="FUNC">hud.solid_line(x1, y1, x2, y2, color)</span>

<p><span class="FUNC">hud.thin_box(x, y, w, h, color)</span>

<p><span class="FUNC">hud.gradient_box(x, y, w, h, TL, BL, TR, BR)</span>

<p><span class="FUNC">hud.draw_image(x, y, name)</span>

<p><span class="FUNC">hud.stretch_image(x, y, w, h, name)</span>

<p><span class="FUNC">hud.tile_image(x, y, w, h, name, [x_offset, y_offset])</span>

<p><span class="FUNC">hud.draw_text(x, y, str)</span>

<p><span class="FUNC">hud.draw_num2(x, y, len, num)</span>

<p><span class="FUNC">hud.render_world(x, y, w, h)</span>

<p><span class="FUNC">hud.render_automap(x, y, w, h)</span>

<p><span class="FUNC">hud.automap_colors(table)</span>



<h2>PLAYER MODULE<h2>


<h3>General Queries</h3>

<p><span class="FUNC">player.is_bot()</span>

<p><span class="FUNC">player.get_name()</span>

<p><span class="FUNC">player.health()</span>

<p><span class="FUNC">player.armor(type)</span>

<p><span class="FUNC">player.total_armor(type)</span>

<p><span class="FUNC">player.frags()</span>

<p><span class="FUNC">player.move_speed()</span>

<p><span class="FUNC">player.air_in_lungs()</span>

<p><span class="FUNC">player.has_key(key)</span>

<p><span class="FUNC">player.has_power(key)</span>


<h3>Weapon Stuff</h3>

<p><span class="FUNC">player.has_weapon_slot(slot)</span>

<p><span class="FUNC">player.has_weapon(name)</span>

<p><span class="FUNC">player.ammo(type)</span>

<p><span class="FUNC">player.ammomax(type)</span>

<p><span class="FUNC">player.main_ammo(clip)</span>

<p><span class="FUNC">player.ammo_type(ATK)</span>

<p><span class="FUNC">player.ammo_pershot(ATK)</span>

<p><span class="FUNC">player.clip_ammo(ATK)</span>

<p><span class="FUNC">player.clip_size(ATK)</span>

<p><span class="FUNC">player.clip_is_shared()</span>


<h3>Conditions</h3>

<p><span class="FUNC">player.under_water()</span>

<p><span class="FUNC">player.on_ground()</span>

<p><span class="FUNC">player.is_swimming()</span>

<p><span class="FUNC">player.is_jumping()</span>

<p><span class="FUNC">player.is_crouching()</span>

<p><span class="FUNC">player.is_attacking()</span>

<p><span class="FUNC">player.is_rampaging()</span>

<p><span class="FUNC">player.is_grinning()</span>

<p><span class="FUNC">player.is_using()</span>

<h3>Miscellaneous</h3>

<p><span class="FUNC">player.num_players()</span>

<p><span class="FUNC">player.set_who(index)</span>

<p><span class="FUNC">player.hurt_by()</span>

<p><span class="FUNC">player.hurt_pain()</span>

<p><span class="FUNC">player.hurt_dir()</span>



<h2>DEFAULT HUD CODE</h2>

<PRE>

<I><FONT COLOR="#EEBB99">--------------------------------------------
</FONT></I><I><FONT COLOR="#EEBB99">--  HUD LUA CODE for EDGE
</FONT></I><I><FONT COLOR="#EEBB99">--  Copyright (c) 2008 The Edge Team.
</FONT></I><I><FONT COLOR="#EEBB99">--  Under the GNU General Public License.
</FONT></I><I><FONT COLOR="#EEBB99">--------------------------------------------
</FONT></I>
face_time <B><FONT COLOR="#77CCDD">=</FONT></B> 0
face_image <B><FONT COLOR="#77CCDD">=</FONT></B> <B><FONT COLOR="#FF4444">&quot;STFST01&quot;</FONT></B>


<B><FONT COLOR="#33CC33">function </FONT></B><B><FONT COLOR="#FFFFFF">doom_weapon_icon</FONT></B><B><FONT COLOR="#33CC33">(slot, x, y, off_pic, on_pic)</FONT></B>
  <B><FONT COLOR="#33CC33">if</FONT></B> player.has_weapon_slot(slot) <B><FONT COLOR="#33CC33">then</FONT></B>
    hud.draw_image(x, y, on_pic)
  <B><FONT COLOR="#33CC33">else</FONT></B>
    hud.draw_image(x, y, off_pic)
  <B><FONT COLOR="#33CC33">end</FONT></B>
<B><FONT COLOR="#33CC33">end</FONT></B>


<B><FONT COLOR="#33CC33">function </FONT></B><B><FONT COLOR="#FFFFFF">doom_key</FONT></B><B><FONT COLOR="#33CC33">(x, y, card, skull, card_pic, skull_pic, both_pic)</FONT></B>

  <B><FONT COLOR="#33CC33">local</FONT></B> has_sk <B><FONT COLOR="#77CCDD">=</FONT></B> player.has_key(skull)
  
  <B><FONT COLOR="#33CC33">if</FONT></B> player.has_key(card) <B><FONT COLOR="#33CC33">then</FONT></B>
    hud.draw_image(x, y, sel(has_sk, both_pic, card_pic))

  <B><FONT COLOR="#33CC33">elseif</FONT></B> has_sk <B><FONT COLOR="#33CC33">then</FONT></B>
    hud.draw_image(x, y, skull_pic)
  <B><FONT COLOR="#33CC33">end</FONT></B>
<B><FONT COLOR="#33CC33">end</FONT></B>


<B><FONT COLOR="#33CC33">function </FONT></B><B><FONT COLOR="#FFFFFF">doomguy_face</FONT></B><B><FONT COLOR="#33CC33">(x, y)</FONT></B>

  <I><FONT COLOR="#EEBB99">-- This routine handles the face states and their timing.
</FONT></I>  <I><FONT COLOR="#EEBB99">-- The precedence of expressions is:
</FONT></I>  <I><FONT COLOR="#EEBB99">--
</FONT></I>  <I><FONT COLOR="#EEBB99">--    dead &gt; evil grin &gt; turned head &gt; straight ahead
</FONT></I>
  <B><FONT COLOR="#33CC33">local</FONT></B> <B><FONT COLOR="#33CC33">function</FONT></B> pain_digit()

    <B><FONT COLOR="#33CC33">local</FONT></B> health <B><FONT COLOR="#77CCDD">=</FONT></B> math.min(100, player.health())
    
    <B><FONT COLOR="#33CC33">local</FONT></B> index <B><FONT COLOR="#77CCDD">=</FONT></B> int(4.99 <B><FONT COLOR="#77CCDD">*</FONT></B> (100 <B><FONT COLOR="#77CCDD">-</FONT></B> health) / 100);

    <B><FONT COLOR="#6666FF">assert</FONT></B>(index <B><FONT COLOR="#77CCDD">&gt;=</FONT></B> 0)
    <B><FONT COLOR="#6666FF">assert</FONT></B>(index <B><FONT COLOR="#77CCDD">&lt;=</FONT></B> 4)

    <B><FONT COLOR="#33CC33">return</FONT></B> <B><FONT COLOR="#6666FF">tostring</FONT></B>(index)
  <B><FONT COLOR="#33CC33">end</FONT></B>


  <B><FONT COLOR="#33CC33">local</FONT></B> <B><FONT COLOR="#33CC33">function</FONT></B> turn_digit()
    <B><FONT COLOR="#33CC33">return</FONT></B> <B><FONT COLOR="#6666FF">tostring</FONT></B>(int(math.random() <B><FONT COLOR="#77CCDD">*</FONT></B> 2.99))
  <B><FONT COLOR="#33CC33">end</FONT></B>


  <B><FONT COLOR="#33CC33">local</FONT></B> <B><FONT COLOR="#33CC33">function</FONT></B> select_new_face()

    <I><FONT COLOR="#EEBB99">-- dead ?
</FONT></I>    <B><FONT COLOR="#33CC33">if</FONT></B> player.health() <B><FONT COLOR="#77CCDD">&lt;=</FONT></B> 0 <B><FONT COLOR="#33CC33">then</FONT></B>
      face_image <B><FONT COLOR="#77CCDD">=</FONT></B> <B><FONT COLOR="#FF4444">&quot;STFDEAD0&quot;</FONT></B>
      face_time  <B><FONT COLOR="#77CCDD">=</FONT></B> 10
      <B><FONT COLOR="#33CC33">return</FONT></B>
    <B><FONT COLOR="#33CC33">end</FONT></B>

    <I><FONT COLOR="#EEBB99">-- evil grin when player just picked up a weapon
</FONT></I>    <B><FONT COLOR="#33CC33">if</FONT></B> player.is_grinning() <B><FONT COLOR="#33CC33">then</FONT></B>
      face_image <B><FONT COLOR="#77CCDD">=</FONT></B> <B><FONT COLOR="#FF4444">&quot;STFEVL&quot;</FONT></B> .. pain_digit()
      face_time  <B><FONT COLOR="#77CCDD">=</FONT></B> 7
      <B><FONT COLOR="#33CC33">return</FONT></B>
    <B><FONT COLOR="#33CC33">end</FONT></B>

    <I><FONT COLOR="#EEBB99">-- being attacked ?
</FONT></I>    <B><FONT COLOR="#33CC33">if</FONT></B> player.hurt_by() <B><FONT COLOR="#33CC33">then</FONT></B>
      
      <B><FONT COLOR="#33CC33">if</FONT></B> player.hurt_pain() <B><FONT COLOR="#77CCDD">&gt;</FONT></B> 50 <B><FONT COLOR="#33CC33">then</FONT></B>
        face_image <B><FONT COLOR="#77CCDD">=</FONT></B> <B><FONT COLOR="#FF4444">&quot;STFOUCH&quot;</FONT></B> .. pain_digit()
        face_time <B><FONT COLOR="#77CCDD">=</FONT></B> 35
        <B><FONT COLOR="#33CC33">return</FONT></B>
      <B><FONT COLOR="#33CC33">end</FONT></B>

      <B><FONT COLOR="#33CC33">local</FONT></B> dir <B><FONT COLOR="#77CCDD">=</FONT></B> 0

      <B><FONT COLOR="#33CC33">if</FONT></B> player.hurt_by() <B><FONT COLOR="#77CCDD">==</FONT></B> <B><FONT COLOR="#FF4444">&quot;enemy&quot;</FONT></B> <B><FONT COLOR="#33CC33">then</FONT></B>
        dir <B><FONT COLOR="#77CCDD">=</FONT></B> player.hurt_dir()
      <B><FONT COLOR="#33CC33">end</FONT></B>

      <B><FONT COLOR="#33CC33">if</FONT></B> dir <B><FONT COLOR="#77CCDD">&lt;</FONT></B> 0 <B><FONT COLOR="#33CC33">then</FONT></B>
        face_image <B><FONT COLOR="#77CCDD">=</FONT></B> <B><FONT COLOR="#FF4444">&quot;STFTL&quot;</FONT></B> .. pain_digit() .. <B><FONT COLOR="#FF4444">&quot;0&quot;</FONT></B>
      <B><FONT COLOR="#33CC33">elseif</FONT></B> dir <B><FONT COLOR="#77CCDD">&gt;</FONT></B> 0 <B><FONT COLOR="#33CC33">then</FONT></B>
        face_image <B><FONT COLOR="#77CCDD">=</FONT></B> <B><FONT COLOR="#FF4444">&quot;STFTR&quot;</FONT></B> .. pain_digit() .. <B><FONT COLOR="#FF4444">&quot;0&quot;</FONT></B>
      <B><FONT COLOR="#33CC33">else</FONT></B>
        face_image <B><FONT COLOR="#77CCDD">=</FONT></B> <B><FONT COLOR="#FF4444">&quot;STFKILL&quot;</FONT></B> .. pain_digit()
      <B><FONT COLOR="#33CC33">end</FONT></B>

      face_time <B><FONT COLOR="#77CCDD">=</FONT></B> 35
      <B><FONT COLOR="#33CC33">return</FONT></B>
    <B><FONT COLOR="#33CC33">end</FONT></B>

    <I><FONT COLOR="#EEBB99">-- rampaging?
</FONT></I>    <B><FONT COLOR="#33CC33">if</FONT></B> player.is_rampaging() <B><FONT COLOR="#33CC33">then</FONT></B>
      face_image <B><FONT COLOR="#77CCDD">=</FONT></B> <B><FONT COLOR="#FF4444">&quot;STFKILL&quot;</FONT></B> .. pain_digit()
      face_time  <B><FONT COLOR="#77CCDD">=</FONT></B> 7
      <B><FONT COLOR="#33CC33">return</FONT></B>
    <B><FONT COLOR="#33CC33">end</FONT></B>

    <I><FONT COLOR="#EEBB99">-- god mode?
</FONT></I>    <B><FONT COLOR="#33CC33">if</FONT></B> player.has_power(POWERS.invuln) <B><FONT COLOR="#33CC33">then</FONT></B>
      face_image <B><FONT COLOR="#77CCDD">=</FONT></B> <B><FONT COLOR="#FF4444">&quot;STFGOD0&quot;</FONT></B>
      face_time  <B><FONT COLOR="#77CCDD">=</FONT></B> 7
      <B><FONT COLOR="#33CC33">return</FONT></B>
    <B><FONT COLOR="#33CC33">end</FONT></B>

    <I><FONT COLOR="#EEBB99">-- default: look about the place...
</FONT></I>    face_image <B><FONT COLOR="#77CCDD">=</FONT></B> <B><FONT COLOR="#FF4444">&quot;STFST&quot;</FONT></B> .. pain_digit() .. turn_digit()
    face_time  <B><FONT COLOR="#77CCDD">=</FONT></B> 17
  <B><FONT COLOR="#33CC33">end</FONT></B>


  <I><FONT COLOR="#EEBB99">---| doomguy_face |---
</FONT></I>
  face_time <B><FONT COLOR="#77CCDD">=</FONT></B> face_time <B><FONT COLOR="#77CCDD">-</FONT></B> hud.passed_time

  <B><FONT COLOR="#33CC33">if</FONT></B> face_time <B><FONT COLOR="#77CCDD">&lt;=</FONT></B> 0 <B><FONT COLOR="#33CC33">then</FONT></B>
    select_new_face()
  <B><FONT COLOR="#33CC33">end</FONT></B>

  <I><FONT COLOR="#EEBB99">-- FIXME faceback
</FONT></I>
  hud.draw_image(x<B><FONT COLOR="#77CCDD">-</FONT></B>1, y<B><FONT COLOR="#77CCDD">-</FONT></B>1, face_image)
<B><FONT COLOR="#33CC33">end</FONT></B>


<B><FONT COLOR="#33CC33">function </FONT></B><B><FONT COLOR="#FFFFFF">doom_status_bar</FONT></B><B><FONT COLOR="#33CC33">()</FONT></B>

  hud.draw_image(  0, 168, <B><FONT COLOR="#FF4444">&quot;STBAR&quot;</FONT></B>);
  hud.draw_image( 90, 171, <B><FONT COLOR="#FF4444">&quot;STTPRCNT&quot;</FONT></B>);
  hud.draw_image(221, 171, <B><FONT COLOR="#FF4444">&quot;STTPRCNT&quot;</FONT></B>);

  hud.text_font(<B><FONT COLOR="#FF4444">&quot;BIG_DIGIT&quot;</FONT></B>)

  hud.draw_num2( 44, 171, 3, player.main_ammo(1));
  hud.draw_num2( 90, 171, 3, player.health());
  hud.draw_num2(221, 171, 3, player.total_armor())

  <B><FONT COLOR="#33CC33">if</FONT></B> hud.game_mode() <B><FONT COLOR="#77CCDD">==</FONT></B> <B><FONT COLOR="#FF4444">&quot;dm&quot;</FONT></B> <B><FONT COLOR="#33CC33">then</FONT></B>

    hud.draw_num2(138, 171, 2, player.frags());

  <B><FONT COLOR="#33CC33">else</FONT></B>
    hud.draw_image(104, 168, <B><FONT COLOR="#FF4444">&quot;STARMS&quot;</FONT></B>);

    doom_weapon_icon(2, 111, 172, <B><FONT COLOR="#FF4444">&quot;STGNUM2&quot;</FONT></B>, <B><FONT COLOR="#FF4444">&quot;STYSNUM2&quot;</FONT></B>); 
    doom_weapon_icon(3, 123, 172, <B><FONT COLOR="#FF4444">&quot;STGNUM3&quot;</FONT></B>, <B><FONT COLOR="#FF4444">&quot;STYSNUM3&quot;</FONT></B>);
    doom_weapon_icon(4, 135, 172, <B><FONT COLOR="#FF4444">&quot;STGNUM4&quot;</FONT></B>, <B><FONT COLOR="#FF4444">&quot;STYSNUM4&quot;</FONT></B>);

    doom_weapon_icon(5, 111, 182, <B><FONT COLOR="#FF4444">&quot;STGNUM5&quot;</FONT></B>, <B><FONT COLOR="#FF4444">&quot;STYSNUM5&quot;</FONT></B>);
    doom_weapon_icon(6, 123, 182, <B><FONT COLOR="#FF4444">&quot;STGNUM6&quot;</FONT></B>, <B><FONT COLOR="#FF4444">&quot;STYSNUM6&quot;</FONT></B>);
    doom_weapon_icon(7, 135, 182, <B><FONT COLOR="#FF4444">&quot;STGNUM7&quot;</FONT></B>, <B><FONT COLOR="#FF4444">&quot;STYSNUM7&quot;</FONT></B>);
  <B><FONT COLOR="#33CC33">end</FONT></B>

  doomguy_face(144, 169)

  doom_key(239, 171, 1, 5, <B><FONT COLOR="#FF4444">&quot;STKEYS0&quot;</FONT></B>, <B><FONT COLOR="#FF4444">&quot;STKEYS3&quot;</FONT></B>, <B><FONT COLOR="#FF4444">&quot;STKEYS6&quot;</FONT></B>)
  doom_key(239, 181, 2, 6, <B><FONT COLOR="#FF4444">&quot;STKEYS1&quot;</FONT></B>, <B><FONT COLOR="#FF4444">&quot;STKEYS4&quot;</FONT></B>, <B><FONT COLOR="#FF4444">&quot;STKEYS7&quot;</FONT></B>)
  doom_key(239, 191, 3, 7, <B><FONT COLOR="#FF4444">&quot;STKEYS2&quot;</FONT></B>, <B><FONT COLOR="#FF4444">&quot;STKEYS5&quot;</FONT></B>, <B><FONT COLOR="#FF4444">&quot;STKEYS8&quot;</FONT></B>)

  hud.text_font(<B><FONT COLOR="#FF4444">&quot;YELLOW_DIGIT&quot;</FONT></B>)

  hud.draw_num2(288, 173, 3, player.ammo(1));
  hud.draw_num2(288, 179, 3, player.ammo(2));
  hud.draw_num2(288, 185, 3, player.ammo(3));
  hud.draw_num2(288, 191, 3, player.ammo(4));

  hud.draw_num2(314, 173, 3, player.ammomax(1));
  hud.draw_num2(314, 179, 3, player.ammomax(2));
  hud.draw_num2(314, 185, 3, player.ammomax(3));
  hud.draw_num2(314, 191, 3, player.ammomax(4));
<B><FONT COLOR="#33CC33">end</FONT></B>


<B><FONT COLOR="#33CC33">function </FONT></B><B><FONT COLOR="#FFFFFF">doom_overlay_status</FONT></B><B><FONT COLOR="#33CC33">()</FONT></B>
  hud.text_font(<B><FONT COLOR="#FF4444">&quot;BIG_DIGIT&quot;</FONT></B>)

  hud.draw_num2(100, 171, 3, player.health());

  hud.text_color(<B><FONT COLOR="#FF4444">&quot;TEXT_YELLOW&quot;</FONT></B>);
  hud.draw_num2( 44, 171, 3, player.main_ammo(1));

  <B><FONT COLOR="#33CC33">if</FONT></B> player.total_armor() <B><FONT COLOR="#77CCDD">&gt;</FONT></B> 100 <B><FONT COLOR="#33CC33">then</FONT></B>
    hud.text_color(<B><FONT COLOR="#FF4444">&quot;TEXT_BLUE&quot;</FONT></B>);
  <B><FONT COLOR="#33CC33">else</FONT></B>
    hud.text_color(<B><FONT COLOR="#FF4444">&quot;TEXT_GREEN&quot;</FONT></B>);
  <B><FONT COLOR="#33CC33">end</FONT></B>
  hud.draw_num2(242, 171, 3, player.total_armor())

  doom_key(256, 171, 1, 5, <B><FONT COLOR="#FF4444">&quot;STKEYS0&quot;</FONT></B>, <B><FONT COLOR="#FF4444">&quot;STKEYS3&quot;</FONT></B>, <B><FONT COLOR="#FF4444">&quot;STKEYS6&quot;</FONT></B>)
  doom_key(256, 181, 2, 6, <B><FONT COLOR="#FF4444">&quot;STKEYS1&quot;</FONT></B>, <B><FONT COLOR="#FF4444">&quot;STKEYS4&quot;</FONT></B>, <B><FONT COLOR="#FF4444">&quot;STKEYS7&quot;</FONT></B>)
  doom_key(256, 191, 3, 7, <B><FONT COLOR="#FF4444">&quot;STKEYS2&quot;</FONT></B>, <B><FONT COLOR="#FF4444">&quot;STKEYS5&quot;</FONT></B>, <B><FONT COLOR="#FF4444">&quot;STKEYS8&quot;</FONT></B>)

  hud.text_font(<B><FONT COLOR="#FF4444">&quot;YELLOW_DIGIT&quot;</FONT></B>)
  hud.text_color(<B><FONT COLOR="#FF4444">&quot;&quot;</FONT></B>);

  hud.draw_num2(288, 173, 3, player.ammo(1));
  hud.draw_num2(288, 179, 3, player.ammo(2));
  hud.draw_num2(288, 185, 3, player.ammo(3));
  hud.draw_num2(288, 191, 3, player.ammo(4));

  hud.draw_num2(314, 173, 3, player.ammomax(1));
  hud.draw_num2(314, 179, 3, player.ammomax(2));
  hud.draw_num2(314, 185, 3, player.ammomax(3));
  hud.draw_num2(314, 191, 3, player.ammomax(4));
<B><FONT COLOR="#33CC33">end</FONT></B>


<B><FONT COLOR="#33CC33">function </FONT></B><B><FONT COLOR="#FFFFFF">doom_automap</FONT></B><B><FONT COLOR="#33CC33">()</FONT></B>

  <I><FONT COLOR="#EEBB99">-- Background is already black, only need to use 'solid_box'
</FONT></I>  <I><FONT COLOR="#EEBB99">-- when we want a different color.
</FONT></I>  <I><FONT COLOR="#EEBB99">--
</FONT></I>  <I><FONT COLOR="#EEBB99">-- hud.solid_box(0, 0, 320, 200-32, &quot;#505050&quot;)
</FONT></I>
  hud.render_automap(0, 0, 320, 200<B><FONT COLOR="#77CCDD">-</FONT></B>32)

  doom_status_bar()

  hud.text_font(<B><FONT COLOR="#FF4444">&quot;DOOM&quot;</FONT></B>)
  hud.draw_text(0, 200<B><FONT COLOR="#77CCDD">-</FONT></B>32<B><FONT COLOR="#77CCDD">-</FONT></B>10, hud.map_title())
<B><FONT COLOR="#33CC33">end</FONT></B>


<B><FONT COLOR="#33CC33">function </FONT></B><B><FONT COLOR="#FFFFFF">edge_air_bar</FONT></B><B><FONT COLOR="#33CC33">()</FONT></B>
  <B><FONT COLOR="#33CC33">if</FONT></B> player.health() <B><FONT COLOR="#77CCDD">&lt;=</FONT></B> 0 <B><FONT COLOR="#33CC33">or</FONT></B> <B><FONT COLOR="#33CC33">not</FONT></B> player.under_water() <B><FONT COLOR="#33CC33">then</FONT></B>
    <B><FONT COLOR="#33CC33">return</FONT></B>
  <B><FONT COLOR="#33CC33">end</FONT></B>

  <B><FONT COLOR="#33CC33">local</FONT></B> air <B><FONT COLOR="#77CCDD">=</FONT></B> player.air_in_lungs()

  air <B><FONT COLOR="#77CCDD">=</FONT></B> int(1 <B><FONT COLOR="#77CCDD">+</FONT></B> 21 <B><FONT COLOR="#77CCDD">*</FONT></B> ((100<B><FONT COLOR="#77CCDD">-</FONT></B>air) / 100.1))

  hud.draw_image(0, 0, string.format(<B><FONT COLOR="#FF4444">&quot;AIRBAR%02d&quot;</FONT></B>, air))
<B><FONT COLOR="#33CC33">end</FONT></B>


<B><FONT COLOR="#33CC33">function</FONT></B> <B><FONT COLOR="#FFFFFF">hud.draw_all</FONT></B><B><FONT COLOR="#33CC33">()</FONT></B>

  hud.coord_sys(640, 400)

  <B><FONT COLOR="#33CC33">if</FONT></B> hud.automap <B><FONT COLOR="#33CC33">then</FONT></B>
    doom_automap()
    <B><FONT COLOR="#33CC33">return</FONT></B>
  <B><FONT COLOR="#33CC33">end</FONT></B>

  <I><FONT COLOR="#EEBB99">-- there are three standard HUDs
</FONT></I>  hud.which <B><FONT COLOR="#77CCDD">=</FONT></B> hud.which <FONT COLOR="#77CCDD">%</FONT> 3

  <B><FONT COLOR="#33CC33">if</FONT></B> hud.which <B><FONT COLOR="#77CCDD">==</FONT></B> 0 <B><FONT COLOR="#33CC33">then</FONT></B>
    hud.render_world(0, 0, 320, 200<B><FONT COLOR="#77CCDD">-</FONT></B>32)
  <B><FONT COLOR="#33CC33">else</FONT></B>
    hud.render_world(0, 0, 320, 200)
  <B><FONT COLOR="#33CC33">end</FONT></B>

  <B><FONT COLOR="#33CC33">if</FONT></B> hud.which <B><FONT COLOR="#77CCDD">==</FONT></B> 0 <B><FONT COLOR="#33CC33">then</FONT></B>
    doom_status_bar()
  <B><FONT COLOR="#33CC33">elseif</FONT></B> hud.which <B><FONT COLOR="#77CCDD">==</FONT></B> 2 <B><FONT COLOR="#33CC33">then</FONT></B>
    doom_overlay_status()
  <B><FONT COLOR="#33CC33">end</FONT></B>

  edge_air_bar()
<B><FONT COLOR="#33CC33">end</FONT></B>

</PRE>

</body>
</html>
